# Import the RAM Legacy Stock Assessment Database into R

[![Travis-CI Build Status](https://travis-ci.org/seananderson/ramlegacy.svg?branch=master)](https://travis-ci.org/seananderson/ramlegacy)

This package does one thing right now: it downloads the latest Microsoft Access version of the [RAM Legacy Stock Assessment Database](http://ramlegacy.org) (version 3.0) and converts it to a local sqlite3 database. This makes it easy to [work with dplyr](http://cran.r-project.org/web/packages/dplyr/vignettes/databases.html), for example. The `make_ramlegacy()` function also leaves a copy of `.csv` files for each table in the database in the R working directory if you'd prefer to work with those. Eventually I may add additional functionality.

**Note that you must have the utility `mdb-tables` installed** and in your path. This utility provides tools for extracting Access databases. You can find installation instructions at <http://mdbtools.sourceforge.net>. If you're on OS X and using homebrew, you can install it with `brew install mdbtools`.

### Example use

```{r knitr-options, cache=FALSE, echo=FALSE}
library("knitr")
opts_chunk$set(cache=TRUE)
```

Install the package:

```{r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("seananderson/ramlegacy")
```

Cache and convert the database:

```{r}
library("ramlegacy")
make_ramlegacy()
```

Work with the data:

```{r}
library("dplyr")
ram <- src_sqlite("ramlegacy.sqlite3")
ram # see the available tables
```

Access the `area` table:

```{r}
area <- tbl(ram, "area")
glimpse(area)
```

Join the time series `ts` and `stock` tables on the `stockid` column:

```{r}
ts <- tbl(ram, "timeseries")
stock <- tbl(ram, "stock")
select(stock, stockid, scientificname, commonname, region) %>%
  inner_join(ts) %>%
  glimpse
```